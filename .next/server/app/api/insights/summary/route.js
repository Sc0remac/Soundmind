"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/insights/summary/route";
exports.ids = ["app/api/insights/summary/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Finsights%2Fsummary%2Froute&page=%2Fapi%2Finsights%2Fsummary%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Finsights%2Fsummary%2Froute.ts&appDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Finsights%2Fsummary%2Froute&page=%2Fapi%2Finsights%2Fsummary%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Finsights%2Fsummary%2Froute.ts&appDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_cormackerr_Desktop_soundmind_app_api_insights_summary_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/insights/summary/route.ts */ \"(rsc)/./app/api/insights/summary/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/insights/summary/route\",\n        pathname: \"/api/insights/summary\",\n        filename: \"route\",\n        bundlePath: \"app/api/insights/summary/route\"\n    },\n    resolvedPagePath: \"/Users/cormackerr/Desktop/soundmind/app/api/insights/summary/route.ts\",\n    nextConfigOutput,\n    userland: _Users_cormackerr_Desktop_soundmind_app_api_insights_summary_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/insights/summary/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZpbnNpZ2h0cyUyRnN1bW1hcnklMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmluc2lnaHRzJTJGc3VtbWFyeSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmluc2lnaHRzJTJGc3VtbWFyeSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmNvcm1hY2tlcnIlMkZEZXNrdG9wJTJGc291bmRtaW5kJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmNvcm1hY2tlcnIlMkZEZXNrdG9wJTJGc291bmRtaW5kJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNxQjtBQUNsRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NvdW5kbWluZC8/NDdjMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvY29ybWFja2Vyci9EZXNrdG9wL3NvdW5kbWluZC9hcHAvYXBpL2luc2lnaHRzL3N1bW1hcnkvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2luc2lnaHRzL3N1bW1hcnkvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9pbnNpZ2h0cy9zdW1tYXJ5XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9pbnNpZ2h0cy9zdW1tYXJ5L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2Nvcm1hY2tlcnIvRGVza3RvcC9zb3VuZG1pbmQvYXBwL2FwaS9pbnNpZ2h0cy9zdW1tYXJ5L3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9pbnNpZ2h0cy9zdW1tYXJ5L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Finsights%2Fsummary%2Froute&page=%2Fapi%2Finsights%2Fsummary%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Finsights%2Fsummary%2Froute.ts&appDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/insights/summary/route.ts":
/*!*******************************************!*\
  !*** ./app/api/insights/summary/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabaseAdmin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabaseAdmin */ \"(rsc)/./lib/supabaseAdmin.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n/* harmony import */ var _lib_stats__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/stats */ \"(rsc)/./lib/stats.ts\");\n// app/api/insights/summary/route.ts\n\n\n\n\nasync function GET(req) {\n    try {\n        const user = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.requireUserFromRequest)(req);\n        const userId = user.id;\n        const { searchParams } = new URL(req.url);\n        const days = Number(searchParams.get(\"days\") || \"30\");\n        const split = searchParams.get(\"split\"); // optional\n        const genre = searchParams.get(\"genre\");\n        const artist = searchParams.get(\"artist\");\n        const since = new Date(Date.now() - days * 86400000).toISOString();\n        const { data, error } = await _lib_supabaseAdmin__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"v_correlations_ready\").select(\"workout_id, started_at, split_name, tonnage_z, pre_energy, pre_valence, pre_top_genre, pre_top_artist, mood_delta\").eq(\"user_id\", userId).gte(\"started_at\", since).order(\"started_at\", {\n            ascending: false\n        });\n        if (error) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message\n        }, {\n            status: 500\n        });\n        let rows = data || [];\n        if (split) rows = rows.filter((r)=>(r.split_name || \"\") === split);\n        if (genre) rows = rows.filter((r)=>(r.pre_top_genre || \"\") === genre);\n        if (artist) rows = rows.filter((r)=>(r.pre_top_artist || \"\") === artist);\n        // --- Music→Performance (energy high vs baseline)\n        const hi = rows.filter((r)=>(r.pre_energy ?? 0) >= 0.7).map((r)=>r.tonnage_z ?? NaN);\n        const lo = rows.filter((r)=>(r.pre_energy ?? 0) < 0.7).map((r)=>r.tonnage_z ?? NaN);\n        const effectPerf = (0,_lib_stats__WEBPACK_IMPORTED_MODULE_3__.diffInMeans)(hi, lo);\n        const perfN = hi.filter(Number.isFinite).length + lo.filter(Number.isFinite).length;\n        // --- Music→Mood (valence high vs baseline)\n        const vhi = rows.filter((r)=>(r.pre_valence ?? 0) >= 0.6).map((r)=>r.mood_delta ?? NaN);\n        const vlo = rows.filter((r)=>(r.pre_valence ?? 0) < 0.6).map((r)=>r.mood_delta ?? NaN);\n        const effectMood = (0,_lib_stats__WEBPACK_IMPORTED_MODULE_3__.diffInMeans)(vhi, vlo);\n        const moodN = vhi.filter(Number.isFinite).length + vlo.filter(Number.isFinite).length;\n        // --- Time of day\n        const byHour = new Map();\n        for (const r of rows){\n            const key = (0,_lib_stats__WEBPACK_IMPORTED_MODULE_3__.bucketHour)(r.started_at);\n            const arr = byHour.get(key) || [];\n            if (Number.isFinite(r.tonnage_z)) arr.push(r.tonnage_z);\n            byHour.set(key, arr);\n        }\n        const timeStats = [\n            ...byHour.entries()\n        ].map(([bucket, zs])=>({\n                bucket,\n                uplift: (0,_lib_stats__WEBPACK_IMPORTED_MODULE_3__.mean)(zs),\n                n: zs.length\n            }));\n        timeStats.sort((a, b)=>(b.uplift || -9) - (a.uplift || -9));\n        const bestTime = timeStats[0] || null;\n        // --- Genres\n        const byGenre = new Map();\n        for (const r of rows){\n            const g = r.pre_top_genre || null;\n            if (!g) continue;\n            const entry = byGenre.get(g) || {\n                perf: [],\n                mood: []\n            };\n            if (Number.isFinite(r.tonnage_z)) entry.perf.push(r.tonnage_z);\n            if (Number.isFinite(r.mood_delta)) entry.mood.push(r.mood_delta);\n            byGenre.set(g, entry);\n        }\n        const genreStats = [\n            ...byGenre.entries()\n        ].map(([g, v])=>({\n                genre: g,\n                perf: (0,_lib_stats__WEBPACK_IMPORTED_MODULE_3__.mean)(v.perf),\n                mood: (0,_lib_stats__WEBPACK_IMPORTED_MODULE_3__.mean)(v.mood),\n                n: Math.max(v.perf.length, v.mood.length)\n            })).filter((g)=>g.n >= 5);\n        const genreCards = [\n            ...genreStats\n        ].sort((a, b)=>(b.perf || -9) - (a.perf || -9)).slice(0, 6);\n        const genreMoodTop = [\n            ...genreStats\n        ].sort((a, b)=>(b.mood || -9) - (a.mood || -9))[0] || null;\n        // --- Artists\n        const byArtist = new Map();\n        for (const r of rows){\n            const a = r.pre_top_artist || null;\n            if (!a) continue;\n            const entry = byArtist.get(a) || {\n                perf: [],\n                mood: []\n            };\n            if (Number.isFinite(r.tonnage_z)) entry.perf.push(r.tonnage_z);\n            if (Number.isFinite(r.mood_delta)) entry.mood.push(r.mood_delta);\n            byArtist.set(a, entry);\n        }\n        const artistStats = [\n            ...byArtist.entries()\n        ].map(([a, v])=>({\n                artist: a,\n                perf: (0,_lib_stats__WEBPACK_IMPORTED_MODULE_3__.mean)(v.perf),\n                mood: (0,_lib_stats__WEBPACK_IMPORTED_MODULE_3__.mean)(v.mood),\n                n: Math.max(v.perf.length, v.mood.length)\n            })).filter((a)=>a.n >= 5);\n        const artistCards = [\n            ...artistStats\n        ].sort((a, b)=>(b.perf || -9) - (a.perf || -9)).slice(0, 6);\n        const artistPerfTop = [\n            ...artistStats\n        ].sort((a, b)=>(b.perf || -9) - (a.perf || -9))[0] || null;\n        const res = {\n            filters: {\n                days,\n                split: split || null,\n                genre: genre || null,\n                artist: artist || null,\n                sample: rows.length\n            },\n            cards: {\n                music_to_performance: {\n                    headline: `High-energy (≥0.7) pre-workout vs baseline`,\n                    uplift: Number.isFinite(effectPerf) ? Number(effectPerf.toFixed(2)) : null,\n                    n: perfN,\n                    confidence: (0,_lib_stats__WEBPACK_IMPORTED_MODULE_3__.confidence)(perfN, Math.abs(effectPerf || 0))\n                },\n                music_to_mood: {\n                    headline: `High-valence (≥0.6) pre vs baseline`,\n                    uplift: Number.isFinite(effectMood) ? Number(effectMood.toFixed(2)) : null,\n                    n: moodN,\n                    confidence: (0,_lib_stats__WEBPACK_IMPORTED_MODULE_3__.confidence)(moodN, Math.abs(effectMood || 0))\n                },\n                top_artist_performance: artistPerfTop ? {\n                    artist: artistPerfTop.artist,\n                    uplift: artistPerfTop.perf,\n                    n: artistPerfTop.n\n                } : null,\n                top_genre_mood: genreMoodTop ? {\n                    genre: genreMoodTop.genre,\n                    uplift: genreMoodTop.mood,\n                    n: genreMoodTop.n\n                } : null,\n                best_time_of_day: bestTime,\n                top_genres: genreCards,\n                top_artists: artistCards\n            }\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(res);\n    } catch (e) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: e?.message || String(e)\n        }, {\n            status: 401\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2luc2lnaHRzL3N1bW1hcnkvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxvQ0FBb0M7QUFDTztBQUNTO0FBQ0E7QUFDb0I7QUFjakUsZUFBZU8sSUFBSUMsR0FBWTtJQUNwQyxJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNUCxpRUFBc0JBLENBQUNNO1FBQzFDLE1BQU1FLFNBQVNELEtBQUtFLEVBQUU7UUFFdEIsTUFBTSxFQUFFQyxZQUFZLEVBQUUsR0FBRyxJQUFJQyxJQUFJTCxJQUFJTSxHQUFHO1FBQ3hDLE1BQU1DLE9BQU9DLE9BQU9KLGFBQWFLLEdBQUcsQ0FBQyxXQUFXO1FBQ2hELE1BQU1DLFFBQVFOLGFBQWFLLEdBQUcsQ0FBQyxVQUFVLFdBQVc7UUFDcEQsTUFBTUUsUUFBUVAsYUFBYUssR0FBRyxDQUFDO1FBQy9CLE1BQU1HLFNBQVNSLGFBQWFLLEdBQUcsQ0FBQztRQUVoQyxNQUFNSSxRQUFRLElBQUlDLEtBQUtBLEtBQUtDLEdBQUcsS0FBS1IsT0FBTyxVQUFXUyxXQUFXO1FBRWpFLE1BQU0sRUFBRUMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNekIsNkRBQWFBLENBQ3hDMEIsSUFBSSxDQUFDLHdCQUNMQyxNQUFNLENBQ0wscUhBRURDLEVBQUUsQ0FBQyxXQUFXbkIsUUFDZG9CLEdBQUcsQ0FBQyxjQUFjVCxPQUNsQlUsS0FBSyxDQUFDLGNBQWM7WUFBRUMsV0FBVztRQUFNO1FBRTFDLElBQUlOLE9BQU8sT0FBTzFCLHFEQUFZQSxDQUFDaUMsSUFBSSxDQUFDO1lBQUVQLE9BQU9BLE1BQU1RLE9BQU87UUFBQyxHQUFHO1lBQUVDLFFBQVE7UUFBSTtRQUU1RSxJQUFJQyxPQUFRWCxRQUFRLEVBQUU7UUFDdEIsSUFBSVAsT0FBT2tCLE9BQU9BLEtBQUtDLE1BQU0sQ0FBQyxDQUFDQyxJQUFNLENBQUNBLEVBQUVDLFVBQVUsSUFBSSxFQUFDLE1BQU9yQjtRQUM5RCxJQUFJQyxPQUFPaUIsT0FB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UUFBSTtJQUM3RTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc291bmRtaW5kLy4vYXBwL2FwaS9pbnNpZ2h0cy9zdW1tYXJ5L3JvdXRlLnRzP2VjNTMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gYXBwL2FwaS9pbnNpZ2h0cy9zdW1tYXJ5L3JvdXRlLnRzXG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IHN1cGFiYXNlQWRtaW4gfSBmcm9tIFwiQC9saWIvc3VwYWJhc2VBZG1pblwiO1xuaW1wb3J0IHsgcmVxdWlyZVVzZXJGcm9tUmVxdWVzdCB9IGZyb20gXCJAL2xpYi9hdXRoXCI7XG5pbXBvcnQgeyBkaWZmSW5NZWFucywgbWVhbiwgY29uZmlkZW5jZSwgYnVja2V0SG91ciB9IGZyb20gXCJAL2xpYi9zdGF0c1wiO1xuXG50eXBlIFJvdyA9IHtcbiAgd29ya291dF9pZDogc3RyaW5nO1xuICBzdGFydGVkX2F0OiBzdHJpbmc7XG4gIHNwbGl0X25hbWU6IHN0cmluZyB8IG51bGw7XG4gIHRvbm5hZ2VfejogbnVtYmVyIHwgbnVsbDtcbiAgcHJlX2VuZXJneTogbnVtYmVyIHwgbnVsbDtcbiAgcHJlX3ZhbGVuY2U6IG51bWJlciB8IG51bGw7XG4gIHByZV90b3BfZ2VucmU6IHN0cmluZyB8IG51bGw7XG4gIHByZV90b3BfYXJ0aXN0OiBzdHJpbmcgfCBudWxsO1xuICBtb29kX2RlbHRhOiBudW1iZXIgfCBudWxsO1xufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXE6IFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgcmVxdWlyZVVzZXJGcm9tUmVxdWVzdChyZXEpO1xuICAgIGNvbnN0IHVzZXJJZCA9IHVzZXIuaWQ7XG5cbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXEudXJsKTtcbiAgICBjb25zdCBkYXlzID0gTnVtYmVyKHNlYXJjaFBhcmFtcy5nZXQoXCJkYXlzXCIpIHx8IFwiMzBcIik7XG4gICAgY29uc3Qgc3BsaXQgPSBzZWFyY2hQYXJhbXMuZ2V0KFwic3BsaXRcIik7IC8vIG9wdGlvbmFsXG4gICAgY29uc3QgZ2VucmUgPSBzZWFyY2hQYXJhbXMuZ2V0KFwiZ2VucmVcIik7XG4gICAgY29uc3QgYXJ0aXN0ID0gc2VhcmNoUGFyYW1zLmdldChcImFydGlzdFwiKTtcblxuICAgIGNvbnN0IHNpbmNlID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIGRheXMgKiA4NjQwMF8wMDApLnRvSVNPU3RyaW5nKCk7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbShcInZfY29ycmVsYXRpb25zX3JlYWR5XCIpXG4gICAgICAuc2VsZWN0KFxuICAgICAgICBcIndvcmtvdXRfaWQsIHN0YXJ0ZWRfYXQsIHNwbGl0X25hbWUsIHRvbm5hZ2VfeiwgcHJlX2VuZXJneSwgcHJlX3ZhbGVuY2UsIHByZV90b3BfZ2VucmUsIHByZV90b3BfYXJ0aXN0LCBtb29kX2RlbHRhXCJcbiAgICAgIClcbiAgICAgIC5lcShcInVzZXJfaWRcIiwgdXNlcklkKVxuICAgICAgLmd0ZShcInN0YXJ0ZWRfYXRcIiwgc2luY2UpXG4gICAgICAub3JkZXIoXCJzdGFydGVkX2F0XCIsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcblxuICAgIGlmIChlcnJvcikgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KTtcblxuICAgIGxldCByb3dzID0gKGRhdGEgfHwgW10pIGFzIFJvd1tdO1xuICAgIGlmIChzcGxpdCkgcm93cyA9IHJvd3MuZmlsdGVyKChyKSA9PiAoci5zcGxpdF9uYW1lIHx8IFwiXCIpID09PSBzcGxpdCk7XG4gICAgaWYgKGdlbnJlKSByb3dzID0gcm93cy5maWx0ZXIoKHIpID0+IChyLnByZV90b3BfZ2VucmUgfHwgXCJcIikgPT09IGdlbnJlKTtcbiAgICBpZiAoYXJ0aXN0KSByb3dzID0gcm93cy5maWx0ZXIoKHIpID0+IChyLnByZV90b3BfYXJ0aXN0IHx8IFwiXCIpID09PSBhcnRpc3QpO1xuXG4gIC8vIC0tLSBNdXNpY+KGklBlcmZvcm1hbmNlIChlbmVyZ3kgaGlnaCB2cyBiYXNlbGluZSlcbiAgY29uc3QgaGkgPSByb3dzLmZpbHRlcigocikgPT4gKHIucHJlX2VuZXJneSA/PyAwKSA+PSAwLjcpLm1hcCgocikgPT4gci50b25uYWdlX3ogPz8gTmFOKTtcbiAgY29uc3QgbG8gPSByb3dzLmZpbHRlcigocikgPT4gKHIucHJlX2VuZXJneSA/PyAwKSA8IDAuNykubWFwKChyKSA9PiByLnRvbm5hZ2VfeiA/PyBOYU4pO1xuICBjb25zdCBlZmZlY3RQZXJmID0gZGlmZkluTWVhbnMoaGksIGxvKTtcbiAgY29uc3QgcGVyZk4gPSBoaS5maWx0ZXIoTnVtYmVyLmlzRmluaXRlKS5sZW5ndGggKyBsby5maWx0ZXIoTnVtYmVyLmlzRmluaXRlKS5sZW5ndGg7XG5cbiAgLy8gLS0tIE11c2lj4oaSTW9vZCAodmFsZW5jZSBoaWdoIHZzIGJhc2VsaW5lKVxuICBjb25zdCB2aGkgPSByb3dzLmZpbHRlcigocikgPT4gKHIucHJlX3ZhbGVuY2UgPz8gMCkgPj0gMC42KS5tYXAoKHIpID0+IHIubW9vZF9kZWx0YSA/PyBOYU4pO1xuICBjb25zdCB2bG8gPSByb3dzLmZpbHRlcigocikgPT4gKHIucHJlX3ZhbGVuY2UgPz8gMCkgPCAwLjYpLm1hcCgocikgPT4gci5tb29kX2RlbHRhID8/IE5hTik7XG4gIGNvbnN0IGVmZmVjdE1vb2QgPSBkaWZmSW5NZWFucyh2aGksIHZsbyk7XG4gIGNvbnN0IG1vb2ROID0gdmhpLmZpbHRlcihOdW1iZXIuaXNGaW5pdGUpLmxlbmd0aCArIHZsby5maWx0ZXIoTnVtYmVyLmlzRmluaXRlKS5sZW5ndGg7XG5cbiAgLy8gLS0tIFRpbWUgb2YgZGF5XG4gIGNvbnN0IGJ5SG91ciA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXJbXT4oKTtcbiAgZm9yIChjb25zdCByIG9mIHJvd3MpIHtcbiAgICBjb25zdCBrZXkgPSBidWNrZXRIb3VyKHIuc3RhcnRlZF9hdCk7XG4gICAgY29uc3QgYXJyID0gYnlIb3VyLmdldChrZXkpIHx8IFtdO1xuICAgIGlmIChOdW1iZXIuaXNGaW5pdGUoci50b25uYWdlX3opKSBhcnIucHVzaChyLnRvbm5hZ2VfeiBhcyBudW1iZXIpO1xuICAgIGJ5SG91ci5zZXQoa2V5LCBhcnIpO1xuICB9XG4gIGNvbnN0IHRpbWVTdGF0cyA9IFsuLi5ieUhvdXIuZW50cmllcygpXS5tYXAoKFtidWNrZXQsIHpzXSkgPT4gKHsgYnVja2V0LCB1cGxpZnQ6IG1lYW4oenMpLCBuOiB6cy5sZW5ndGggfSkpO1xuICB0aW1lU3RhdHMuc29ydCgoYSwgYikgPT4gKGIudXBsaWZ0IHx8IC05KSAtIChhLnVwbGlmdCB8fCAtOSkpO1xuICBjb25zdCBiZXN0VGltZSA9IHRpbWVTdGF0c1swXSB8fCBudWxsO1xuXG4gIC8vIC0tLSBHZW5yZXNcbiAgY29uc3QgYnlHZW5yZSA9IG5ldyBNYXA8c3RyaW5nLCB7IHBlcmY6IG51bWJlcltdOyBtb29kOiBudW1iZXJbXSB9PigpO1xuICBmb3IgKGNvbnN0IHIgb2Ygcm93cykge1xuICAgIGNvbnN0IGcgPSByLnByZV90b3BfZ2VucmUgfHwgbnVsbDtcbiAgICBpZiAoIWcpIGNvbnRpbnVlO1xuICAgIGNvbnN0IGVudHJ5ID0gYnlHZW5yZS5nZXQoZykgfHwgeyBwZXJmOiBbXSwgbW9vZDogW10gfTtcbiAgICBpZiAoTnVtYmVyLmlzRmluaXRlKHIudG9ubmFnZV96KSkgZW50cnkucGVyZi5wdXNoKHIudG9ubmFnZV96IGFzIG51bWJlcik7XG4gICAgaWYgKE51bWJlci5pc0Zpbml0ZShyLm1vb2RfZGVsdGEpKSBlbnRyeS5tb29kLnB1c2goci5tb29kX2RlbHRhIGFzIG51bWJlcik7XG4gICAgYnlHZW5yZS5zZXQoZywgZW50cnkpO1xuICB9XG4gIGNvbnN0IGdlbnJlU3RhdHMgPSBbLi4uYnlHZW5yZS5lbnRyaWVzKCldXG4gICAgLm1hcCgoW2csIHZdKSA9PiAoe1xuICAgICAgZ2VucmU6IGcsXG4gICAgICBwZXJmOiBtZWFuKHYucGVyZiksXG4gICAgICBtb29kOiBtZWFuKHYubW9vZCksXG4gICAgICBuOiBNYXRoLm1heCh2LnBlcmYubGVuZ3RoLCB2Lm1vb2QubGVuZ3RoKSxcbiAgICB9KSlcbiAgICAuZmlsdGVyKChnKSA9PiBnLm4gPj0gNSk7XG5cbiAgY29uc3QgZ2VucmVDYXJkcyA9IFsuLi5nZW5yZVN0YXRzXVxuICAgIC5zb3J0KChhLCBiKSA9PiAoYi5wZXJmIHx8IC05KSAtIChhLnBlcmYgfHwgLTkpKVxuICAgIC5zbGljZSgwLCA2KTtcbiAgY29uc3QgZ2VucmVNb29kVG9wID0gWy4uLmdlbnJlU3RhdHNdXG4gICAgLnNvcnQoKGEsIGIpID0+IChiLm1vb2QgfHwgLTkpIC0gKGEubW9vZCB8fCAtOSkpWzBdIHx8IG51bGw7XG5cbiAgLy8gLS0tIEFydGlzdHNcbiAgY29uc3QgYnlBcnRpc3QgPSBuZXcgTWFwPHN0cmluZywgeyBwZXJmOiBudW1iZXJbXTsgbW9vZDogbnVtYmVyW10gfT4oKTtcbiAgZm9yIChjb25zdCByIG9mIHJvd3MpIHtcbiAgICBjb25zdCBhID0gci5wcmVfdG9wX2FydGlzdCB8fCBudWxsO1xuICAgIGlmICghYSkgY29udGludWU7XG4gICAgY29uc3QgZW50cnkgPSBieUFydGlzdC5nZXQoYSkgfHwgeyBwZXJmOiBbXSwgbW9vZDogW10gfTtcbiAgICBpZiAoTnVtYmVyLmlzRmluaXRlKHIudG9ubmFnZV96KSkgZW50cnkucGVyZi5wdXNoKHIudG9ubmFnZV96IGFzIG51bWJlcik7XG4gICAgaWYgKE51bWJlci5pc0Zpbml0ZShyLm1vb2RfZGVsdGEpKSBlbnRyeS5tb29kLnB1c2goci5tb29kX2RlbHRhIGFzIG51bWJlcik7XG4gICAgYnlBcnRpc3Quc2V0KGEsIGVudHJ5KTtcbiAgfVxuICBjb25zdCBhcnRpc3RTdGF0cyA9IFsuLi5ieUFydGlzdC5lbnRyaWVzKCldXG4gICAgLm1hcCgoW2EsIHZdKSA9PiAoe1xuICAgICAgYXJ0aXN0OiBhLFxuICAgICAgcGVyZjogbWVhbih2LnBlcmYpLFxuICAgICAgbW9vZDogbWVhbih2Lm1vb2QpLFxuICAgICAgbjogTWF0aC5tYXgodi5wZXJmLmxlbmd0aCwgdi5tb29kLmxlbmd0aCksXG4gICAgfSkpXG4gICAgLmZpbHRlcigoYSkgPT4gYS5uID49IDUpO1xuXG4gIGNvbnN0IGFydGlzdENhcmRzID0gWy4uLmFydGlzdFN0YXRzXVxuICAgIC5zb3J0KChhLCBiKSA9PiAoYi5wZXJmIHx8IC05KSAtIChhLnBlcmYgfHwgLTkpKVxuICAgIC5zbGljZSgwLCA2KTtcbiAgY29uc3QgYXJ0aXN0UGVyZlRvcCA9IFsuLi5hcnRpc3RTdGF0c11cbiAgICAuc29ydCgoYSwgYikgPT4gKGIucGVyZiB8fCAtOSkgLSAoYS5wZXJmIHx8IC05KSlbMF0gfHwgbnVsbDtcblxuICBjb25zdCByZXMgPSB7XG4gICAgZmlsdGVyczogeyBkYXlzLCBzcGxpdDogc3BsaXQgfHwgbnVsbCwgZ2VucmU6IGdlbnJlIHx8IG51bGwsIGFydGlzdDogYXJ0aXN0IHx8IG51bGwsIHNhbXBsZTogcm93cy5sZW5ndGggfSxcbiAgICBjYXJkczoge1xuICAgICAgbXVzaWNfdG9fcGVyZm9ybWFuY2U6IHtcbiAgICAgICAgaGVhZGxpbmU6IGBIaWdoLWVuZXJneSAo4omlMC43KSBwcmUtd29ya291dCB2cyBiYXNlbGluZWAsXG4gICAgICAgIHVwbGlmdDogTnVtYmVyLmlzRmluaXRlKGVmZmVjdFBlcmYpID8gTnVtYmVyKGVmZmVjdFBlcmYudG9GaXhlZCgyKSkgOiBudWxsLFxuICAgICAgICBuOiBwZXJmTixcbiAgICAgICAgY29uZmlkZW5jZTogY29uZmlkZW5jZShwZXJmTiwgTWF0aC5hYnMoZWZmZWN0UGVyZiB8fCAwKSksXG4gICAgICB9LFxuICAgICAgbXVzaWNfdG9fbW9vZDoge1xuICAgICAgICBoZWFkbGluZTogYEhpZ2gtdmFsZW5jZSAo4omlMC42KSBwcmUgdnMgYmFzZWxpbmVgLFxuICAgICAgICB1cGxpZnQ6IE51bWJlci5pc0Zpbml0ZShlZmZlY3RNb29kKSA/IE51bWJlcihlZmZlY3RNb29kLnRvRml4ZWQoMikpIDogbnVsbCxcbiAgICAgICAgbjogbW9vZE4sXG4gICAgICAgIGNvbmZpZGVuY2U6IGNvbmZpZGVuY2UobW9vZE4sIE1hdGguYWJzKGVmZmVjdE1vb2QgfHwgMCkpLFxuICAgICAgfSxcbiAgICAgIHRvcF9hcnRpc3RfcGVyZm9ybWFuY2U6IGFydGlzdFBlcmZUb3BcbiAgICAgICAgPyB7IGFydGlzdDogYXJ0aXN0UGVyZlRvcC5hcnRpc3QsIHVwbGlmdDogYXJ0aXN0UGVyZlRvcC5wZXJmLCBuOiBhcnRpc3RQZXJmVG9wLm4gfVxuICAgICAgICA6IG51bGwsXG4gICAgICB0b3BfZ2VucmVfbW9vZDogZ2VucmVNb29kVG9wXG4gICAgICAgID8geyBnZW5yZTogZ2VucmVNb29kVG9wLmdlbnJlLCB1cGxpZnQ6IGdlbnJlTW9vZFRvcC5tb29kLCBuOiBnZW5yZU1vb2RUb3AubiB9XG4gICAgICAgIDogbnVsbCxcbiAgICAgIGJlc3RfdGltZV9vZl9kYXk6IGJlc3RUaW1lLFxuICAgICAgdG9wX2dlbnJlczogZ2VucmVDYXJkcyxcbiAgICAgIHRvcF9hcnRpc3RzOiBhcnRpc3RDYXJkcyxcbiAgICB9LFxuICB9O1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlcyk7XG4gIH0gY2F0Y2ggKGU6IGFueSkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBlPy5tZXNzYWdlIHx8IFN0cmluZyhlKSB9LCB7IHN0YXR1czogNDAxIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwic3VwYWJhc2VBZG1pbiIsInJlcXVpcmVVc2VyRnJvbVJlcXVlc3QiLCJkaWZmSW5NZWFucyIsIm1lYW4iLCJjb25maWRlbmNlIiwiYnVja2V0SG91ciIsIkdFVCIsInJlcSIsInVzZXIiLCJ1c2VySWQiLCJpZCIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsImRheXMiLCJOdW1iZXIiLCJnZXQiLCJzcGxpdCIsImdlbnJlIiwiYXJ0aXN0Iiwic2luY2UiLCJEYXRlIiwibm93IiwidG9JU09TdHJpbmciLCJkYXRhIiwiZXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJndGUiLCJvcmRlciIsImFzY2VuZGluZyIsImpzb24iLCJtZXNzYWdlIiwic3RhdHVzIiwicm93cyIsImZpbHRlciIsInIiLCJzcGxpdF9uYW1lIiwicHJlX3RvcF9nZW5yZSIsInByZV90b3BfYXJ0aXN0IiwiaGkiLCJwcmVfZW5lcmd5IiwibWFwIiwidG9ubmFnZV96IiwiTmFOIiwibG8iLCJlZmZlY3RQZXJmIiwicGVyZk4iLCJpc0Zpbml0ZSIsImxlbmd0aCIsInZoaSIsInByZV92YWxlbmNlIiwibW9vZF9kZWx0YSIsInZsbyIsImVmZmVjdE1vb2QiLCJtb29kTiIsImJ5SG91ciIsIk1hcCIsImtleSIsInN0YXJ0ZWRfYXQiLCJhcnIiLCJwdXNoIiwic2V0IiwidGltZVN0YXRzIiwiZW50cmllcyIsImJ1Y2tldCIsInpzIiwidXBsaWZ0IiwibiIsInNvcnQiLCJhIiwiYiIsImJlc3RUaW1lIiwiYnlHZW5yZSIsImciLCJlbnRyeSIsInBlcmYiLCJtb29kIiwiZ2VucmVTdGF0cyIsInYiLCJNYXRoIiwibWF4IiwiZ2VucmVDYXJkcyIsInNsaWNlIiwiZ2VucmVNb29kVG9wIiwiYnlBcnRpc3QiLCJhcnRpc3RTdGF0cyIsImFydGlzdENhcmRzIiwiYXJ0aXN0UGVyZlRvcCIsInJlcyIsImZpbHRlcnMiLCJzYW1wbGUiLCJjYXJkcyIsIm11c2ljX3RvX3BlcmZvcm1hbmNlIiwiaGVhZGxpbmUiLCJ0b0ZpeGVkIiwiYWJzIiwibXVzaWNfdG9fbW9vZCIsInRvcF9hcnRpc3RfcGVyZm9ybWFuY2UiLCJ0b3BfZ2VucmVfbW9vZCIsImJlc3RfdGltZV9vZl9kYXkiLCJ0b3BfZ2VucmVzIiwidG9wX2FydGlzdHMiLCJlIiwiU3RyaW5nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/insights/summary/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getBearerFromRequest: () => (/* binding */ getBearerFromRequest),\n/* harmony export */   requireUserFromRequest: () => (/* binding */ requireUserFromRequest),\n/* harmony export */   supabaseFromRequest: () => (/* binding */ supabaseFromRequest)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n// lib/auth.ts\n\nfunction getBearerFromRequest(req) {\n    const a = req.headers.get(\"authorization\") || req.headers.get(\"Authorization\") || \"\";\n    const m = a.match(/^Bearer\\s+(.+)$/i);\n    return m ? m[1] : null;\n}\nfunction getEnv() {\n    const url = \"https://awxeorfppxdsygnhxlth.supabase.co\" || 0;\n    const key = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF3eGVvcmZwcHhkc3lnbmh4bHRoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2MTExOTUsImV4cCI6MjA3MDE4NzE5NX0.62qbnPYJc-UKAYiedhe9EhMcTTgO5iX6RniGKGr6rtk\" || 0;\n    if (!url || !key) throw new Error(\"Supabase URL/Anon key missing in env.\");\n    return {\n        url,\n        key\n    };\n}\n/** RLS-aware Supabase client using the user's JWT from the request */ function supabaseFromRequest(req) {\n    const { url, key } = getEnv();\n    const jwt = getBearerFromRequest(req);\n    const supa = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(url, key, {\n        auth: {\n            persistSession: false,\n            autoRefreshToken: false\n        },\n        global: {\n            headers: jwt ? {\n                Authorization: `Bearer ${jwt}`\n            } : {}\n        }\n    });\n    return {\n        supa,\n        jwt\n    };\n}\nasync function requireUserFromRequest(req) {\n    const { supa } = supabaseFromRequest(req);\n    const { data, error } = await supa.auth.getUser();\n    if (error || !data?.user) throw new Error(error?.message || \"Unauthorized\");\n    return data.user;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUEsY0FBYztBQUN1QztBQUU5QyxTQUFTQyxxQkFBcUJDLEdBQVk7SUFDL0MsTUFBTUMsSUFBSUQsSUFBSUUsT0FBTyxDQUFDQyxHQUFHLENBQUMsb0JBQW9CSCxJQUFJRSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxvQkFBb0I7SUFDbEYsTUFBTUMsSUFBSUgsRUFBRUksS0FBSyxDQUFDO0lBQ2xCLE9BQU9ELElBQUlBLENBQUMsQ0FBQyxFQUFFLEdBQUc7QUFDcEI7QUFFQSxTQUFTRTtJQUNQLE1BQU1DLE1BQU1DLDBDQUFvQyxJQUFJQSxDQUF3QjtJQUM1RSxNQUFNSSxNQUFNSixrTkFBeUMsSUFBSUEsQ0FBNkI7SUFDdEYsSUFBSSxDQUFDRCxPQUFPLENBQUNLLEtBQUssTUFBTSxJQUFJRyxNQUFNO0lBQ2xDLE9BQU87UUFBRVI7UUFBS0s7SUFBSTtBQUNwQjtBQUVBLG9FQUFvRSxHQUM3RCxTQUFTSSxvQkFBb0JoQixHQUFZO0lBQzlDLE1BQU0sRUFBRU8sR0FBRyxFQUFFSyxHQUFHLEVBQUUsR0FBR047SUFDckIsTUFBTVcsTUFBTWxCLHFCQUFxQkM7SUFDakMsTUFBTWtCLE9BQU9wQixtRUFBWUEsQ0FBQ1MsS0FBS0ssS0FBSztRQUNsQ08sTUFBTTtZQUFFQyxnQkFBZ0I7WUFBT0Msa0JBQWtCO1FBQU07UUFDdkRDLFFBQVE7WUFBRXBCLFNBQVNlLE1BQU07Z0JBQUVNLGVBQWUsQ0FBQyxPQUFPLEVBQUVOLElBQUksQ0FBQztZQUFDLElBQUksQ0FBQztRQUFFO0lBQ25FO0lBQ0EsT0FBTztRQUFFQztRQUFNRDtJQUFJO0FBQ3JCO0FBRU8sZUFBZU8sdUJBQXVCeEIsR0FBWTtJQUN2RCxNQUFNLEVBQUVrQixJQUFJLEVBQUUsR0FBR0Ysb0JBQW9CaEI7SUFDckMsTUFBTSxFQUFFeUIsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNUixLQUFLQyxJQUFJLENBQUNRLE9BQU87SUFDL0MsSUFBSUQsU0FBUyxDQUFDRCxNQUFNRyxNQUFNLE1BQU0sSUFBSWIsTUFBTVcsT0FBT0csV0FBVztJQUM1RCxPQUFPSixLQUFLRyxJQUFJO0FBQ2xCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc291bmRtaW5kLy4vbGliL2F1dGgudHM/YmY3ZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBsaWIvYXV0aC50c1xuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zdXBhYmFzZS1qc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmVhcmVyRnJvbVJlcXVlc3QocmVxOiBSZXF1ZXN0KTogc3RyaW5nIHwgbnVsbCB7XG4gIGNvbnN0IGEgPSByZXEuaGVhZGVycy5nZXQoXCJhdXRob3JpemF0aW9uXCIpIHx8IHJlcS5oZWFkZXJzLmdldChcIkF1dGhvcml6YXRpb25cIikgfHwgXCJcIjtcbiAgY29uc3QgbSA9IGEubWF0Y2goL15CZWFyZXJcXHMrKC4rKSQvaSk7XG4gIHJldHVybiBtID8gbVsxXSA6IG51bGw7XG59XG5cbmZ1bmN0aW9uIGdldEVudigpIHtcbiAgY29uc3QgdXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIHx8IHByb2Nlc3MuZW52LlNVUEFCQVNFX1VSTDtcbiAgY29uc3Qga2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgfHwgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfQU5PTl9LRVk7XG4gIGlmICghdXJsIHx8ICFrZXkpIHRocm93IG5ldyBFcnJvcihcIlN1cGFiYXNlIFVSTC9Bbm9uIGtleSBtaXNzaW5nIGluIGVudi5cIik7XG4gIHJldHVybiB7IHVybCwga2V5IH07XG59XG5cbi8qKiBSTFMtYXdhcmUgU3VwYWJhc2UgY2xpZW50IHVzaW5nIHRoZSB1c2VyJ3MgSldUIGZyb20gdGhlIHJlcXVlc3QgKi9cbmV4cG9ydCBmdW5jdGlvbiBzdXBhYmFzZUZyb21SZXF1ZXN0KHJlcTogUmVxdWVzdCkge1xuICBjb25zdCB7IHVybCwga2V5IH0gPSBnZXRFbnYoKTtcbiAgY29uc3Qgand0ID0gZ2V0QmVhcmVyRnJvbVJlcXVlc3QocmVxKTtcbiAgY29uc3Qgc3VwYSA9IGNyZWF0ZUNsaWVudCh1cmwsIGtleSwge1xuICAgIGF1dGg6IHsgcGVyc2lzdFNlc3Npb246IGZhbHNlLCBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSB9LFxuICAgIGdsb2JhbDogeyBoZWFkZXJzOiBqd3QgPyB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtqd3R9YCB9IDoge30gfSxcbiAgfSk7XG4gIHJldHVybiB7IHN1cGEsIGp3dCB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVVzZXJGcm9tUmVxdWVzdChyZXE6IFJlcXVlc3QpIHtcbiAgY29uc3QgeyBzdXBhIH0gPSBzdXBhYmFzZUZyb21SZXF1ZXN0KHJlcSk7XG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGEuYXV0aC5nZXRVc2VyKCk7XG4gIGlmIChlcnJvciB8fCAhZGF0YT8udXNlcikgdGhyb3cgbmV3IEVycm9yKGVycm9yPy5tZXNzYWdlIHx8IFwiVW5hdXRob3JpemVkXCIpO1xuICByZXR1cm4gZGF0YS51c2VyO1xufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsImdldEJlYXJlckZyb21SZXF1ZXN0IiwicmVxIiwiYSIsImhlYWRlcnMiLCJnZXQiLCJtIiwibWF0Y2giLCJnZXRFbnYiLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiU1VQQUJBU0VfVVJMIiwia2V5IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJTVVBBQkFTRV9BTk9OX0tFWSIsIkVycm9yIiwic3VwYWJhc2VGcm9tUmVxdWVzdCIsImp3dCIsInN1cGEiLCJhdXRoIiwicGVyc2lzdFNlc3Npb24iLCJhdXRvUmVmcmVzaFRva2VuIiwiZ2xvYmFsIiwiQXV0aG9yaXphdGlvbiIsInJlcXVpcmVVc2VyRnJvbVJlcXVlc3QiLCJkYXRhIiwiZXJyb3IiLCJnZXRVc2VyIiwidXNlciIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/stats.ts":
/*!**********************!*\
  !*** ./lib/stats.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bpmBand: () => (/* binding */ bpmBand),\n/* harmony export */   bucketHour: () => (/* binding */ bucketHour),\n/* harmony export */   confidence: () => (/* binding */ confidence),\n/* harmony export */   diffInMeans: () => (/* binding */ diffInMeans),\n/* harmony export */   mean: () => (/* binding */ mean),\n/* harmony export */   sd: () => (/* binding */ sd)\n/* harmony export */ });\n// lib/stats.ts\nfunction mean(xs) {\n    const arr = xs.filter((n)=>Number.isFinite(n));\n    return arr.length ? arr.reduce((a, b)=>a + b, 0) / arr.length : NaN;\n}\nfunction sd(xs) {\n    const m = mean(xs);\n    const arr = xs.filter((n)=>Number.isFinite(n));\n    if (!arr.length) return NaN;\n    const v = mean(arr.map((x)=>(x - m) ** 2));\n    return Math.sqrt(v);\n}\nfunction diffInMeans(a, b) {\n    return mean(a) - mean(b);\n}\nfunction bucketHour(dateIso) {\n    const d = new Date(dateIso);\n    const h = d.getHours();\n    if (h < 10) return \"06–09\";\n    if (h < 13) return \"10–12\";\n    if (h < 17) return \"13–16\";\n    if (h < 21) return \"17–20\";\n    return \"21–01\";\n}\nfunction bpmBand(bpm) {\n    if (bpm == null || isNaN(bpm)) return null;\n    if (bpm < 110) return \"<110\";\n    if (bpm < 128) return \"110–127\";\n    if (bpm <= 135) return \"128–135\";\n    return \">135\";\n}\nfunction confidence(n, effectAbs) {\n    if (n >= 25 && effectAbs >= 0.30) return \"high\";\n    if (n >= 10 && effectAbs >= 0.15) return \"medium\";\n    return \"low\";\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3RhdHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsZUFBZTtBQUNSLFNBQVNBLEtBQUtDLEVBQVk7SUFDL0IsTUFBTUMsTUFBTUQsR0FBR0UsTUFBTSxDQUFDLENBQUNDLElBQU1DLE9BQU9DLFFBQVEsQ0FBQ0Y7SUFDN0MsT0FBT0YsSUFBSUssTUFBTSxHQUFHTCxJQUFJTSxNQUFNLENBQUMsQ0FBQ0MsR0FBR0MsSUFBTUQsSUFBSUMsR0FBRyxLQUFLUixJQUFJSyxNQUFNLEdBQUdJO0FBQ3BFO0FBQ08sU0FBU0MsR0FBR1gsRUFBWTtJQUM3QixNQUFNWSxJQUFJYixLQUFLQztJQUNmLE1BQU1DLE1BQU1ELEdBQUdFLE1BQU0sQ0FBQyxDQUFDQyxJQUFNQyxPQUFPQyxRQUFRLENBQUNGO0lBQzdDLElBQUksQ0FBQ0YsSUFBSUssTUFBTSxFQUFFLE9BQU9JO0lBQ3hCLE1BQU1HLElBQUlkLEtBQUtFLElBQUlhLEdBQUcsQ0FBQyxDQUFDQyxJQUFNLENBQUNBLElBQUlILENBQUFBLEtBQU07SUFDekMsT0FBT0ksS0FBS0MsSUFBSSxDQUFDSjtBQUNuQjtBQUNPLFNBQVNLLFlBQVlWLENBQVcsRUFBRUMsQ0FBVztJQUNsRCxPQUFPVixLQUFLUyxLQUFLVCxLQUFLVTtBQUN4QjtBQUNPLFNBQVNVLFdBQVdDLE9BQWU7SUFDeEMsTUFBTUMsSUFBSSxJQUFJQyxLQUFLRjtJQUNuQixNQUFNRyxJQUFJRixFQUFFRyxRQUFRO0lBQ3BCLElBQUlELElBQUksSUFBSSxPQUFPO0lBQ25CLElBQUlBLElBQUksSUFBSSxPQUFPO0lBQ25CLElBQUlBLElBQUksSUFBSSxPQUFPO0lBQ25CLElBQUlBLElBQUksSUFBSSxPQUFPO0lBQ25CLE9BQU87QUFDVDtBQUNPLFNBQVNFLFFBQVFDLEdBQW1CO0lBQ3pDLElBQUlBLE9BQU8sUUFBUUMsTUFBTUQsTUFBTSxPQUFPO0lBQ3RDLElBQUlBLE1BQU0sS0FBSyxPQUFPO0lBQ3RCLElBQUlBLE1BQU0sS0FBSyxPQUFPO0lBQ3RCLElBQUlBLE9BQU8sS0FBSyxPQUFPO0lBQ3ZCLE9BQU87QUFDVDtBQUNPLFNBQVNFLFdBQVd6QixDQUFTLEVBQUUwQixTQUFpQjtJQUNyRCxJQUFJMUIsS0FBSyxNQUFNMEIsYUFBYSxNQUFNLE9BQU87SUFDekMsSUFBSTFCLEtBQUssTUFBTTBCLGFBQWEsTUFBTSxPQUFPO0lBQ3pDLE9BQU87QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3NvdW5kbWluZC8uL2xpYi9zdGF0cy50cz8yMmYxIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9zdGF0cy50c1xuZXhwb3J0IGZ1bmN0aW9uIG1lYW4oeHM6IG51bWJlcltdKSB7XG4gIGNvbnN0IGFyciA9IHhzLmZpbHRlcigobikgPT4gTnVtYmVyLmlzRmluaXRlKG4pKTtcbiAgcmV0dXJuIGFyci5sZW5ndGggPyBhcnIucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCkgLyBhcnIubGVuZ3RoIDogTmFOO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHNkKHhzOiBudW1iZXJbXSkge1xuICBjb25zdCBtID0gbWVhbih4cyk7XG4gIGNvbnN0IGFyciA9IHhzLmZpbHRlcigobikgPT4gTnVtYmVyLmlzRmluaXRlKG4pKTtcbiAgaWYgKCFhcnIubGVuZ3RoKSByZXR1cm4gTmFOO1xuICBjb25zdCB2ID0gbWVhbihhcnIubWFwKCh4KSA9PiAoeCAtIG0pICoqIDIpKTtcbiAgcmV0dXJuIE1hdGguc3FydCh2KTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBkaWZmSW5NZWFucyhhOiBudW1iZXJbXSwgYjogbnVtYmVyW10pIHtcbiAgcmV0dXJuIG1lYW4oYSkgLSBtZWFuKGIpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGJ1Y2tldEhvdXIoZGF0ZUlzbzogc3RyaW5nKSB7XG4gIGNvbnN0IGQgPSBuZXcgRGF0ZShkYXRlSXNvKTtcbiAgY29uc3QgaCA9IGQuZ2V0SG91cnMoKTtcbiAgaWYgKGggPCAxMCkgcmV0dXJuIFwiMDbigJMwOVwiO1xuICBpZiAoaCA8IDEzKSByZXR1cm4gXCIxMOKAkzEyXCI7XG4gIGlmIChoIDwgMTcpIHJldHVybiBcIjEz4oCTMTZcIjtcbiAgaWYgKGggPCAyMSkgcmV0dXJuIFwiMTfigJMyMFwiO1xuICByZXR1cm4gXCIyMeKAkzAxXCI7XG59XG5leHBvcnQgZnVuY3Rpb24gYnBtQmFuZChicG0/OiBudW1iZXIgfCBudWxsKTogc3RyaW5nIHwgbnVsbCB7XG4gIGlmIChicG0gPT0gbnVsbCB8fCBpc05hTihicG0pKSByZXR1cm4gbnVsbDtcbiAgaWYgKGJwbSA8IDExMCkgcmV0dXJuIFwiPDExMFwiO1xuICBpZiAoYnBtIDwgMTI4KSByZXR1cm4gXCIxMTDigJMxMjdcIjtcbiAgaWYgKGJwbSA8PSAxMzUpIHJldHVybiBcIjEyOOKAkzEzNVwiO1xuICByZXR1cm4gXCI+MTM1XCI7XG59XG5leHBvcnQgZnVuY3Rpb24gY29uZmlkZW5jZShuOiBudW1iZXIsIGVmZmVjdEFiczogbnVtYmVyKSB7XG4gIGlmIChuID49IDI1ICYmIGVmZmVjdEFicyA+PSAwLjMwKSByZXR1cm4gXCJoaWdoXCI7XG4gIGlmIChuID49IDEwICYmIGVmZmVjdEFicyA+PSAwLjE1KSByZXR1cm4gXCJtZWRpdW1cIjtcbiAgcmV0dXJuIFwibG93XCI7XG59XG4iXSwibmFtZXMiOlsibWVhbiIsInhzIiwiYXJyIiwiZmlsdGVyIiwibiIsIk51bWJlciIsImlzRmluaXRlIiwibGVuZ3RoIiwicmVkdWNlIiwiYSIsImIiLCJOYU4iLCJzZCIsIm0iLCJ2IiwibWFwIiwieCIsIk1hdGgiLCJzcXJ0IiwiZGlmZkluTWVhbnMiLCJidWNrZXRIb3VyIiwiZGF0ZUlzbyIsImQiLCJEYXRlIiwiaCIsImdldEhvdXJzIiwiYnBtQmFuZCIsImJwbSIsImlzTmFOIiwiY29uZmlkZW5jZSIsImVmZmVjdEFicyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/stats.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabaseAdmin.ts":
/*!******************************!*\
  !*** ./lib/supabaseAdmin.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin),\n/* harmony export */   supabaseService: () => (/* binding */ supabaseService),\n/* harmony export */   usingServiceRole: () => (/* binding */ usingServiceRole)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n// lib/supabaseAdmin.ts\n\nconst url = \"https://awxeorfppxdsygnhxlth.supabase.co\";\nconst serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n// Expose whether the service role key is configured so API routes can bail early\nconst usingServiceRole = !!(url && serviceKey);\n// Lazily create a Supabase client that uses the service role key.  This should\n// only be used in server-side code as it has full access to the database.\nfunction supabaseService() {\n    if (!usingServiceRole) {\n        throw new Error(\"SUPABASE_SERVICE_ROLE_KEY is not set\");\n    }\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(url, serviceKey, {\n        auth: {\n            persistSession: false,\n            autoRefreshToken: false\n        }\n    });\n}\n// Convenience singleton for callers that just need a client instance.\nconst supabaseAdmin = usingServiceRole ? supabaseService() : null;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2VBZG1pbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUEsdUJBQXVCO0FBQzhCO0FBRXJELE1BQU1DLE1BQU1DLDBDQUFvQztBQUNoRCxNQUFNRyxhQUFhSCxRQUFRQyxHQUFHLENBQUNHLHlCQUF5QjtBQUV4RCxpRkFBaUY7QUFDMUUsTUFBTUMsbUJBQW1CLENBQUMsQ0FBRU4sQ0FBQUEsT0FBT0ksVUFBUyxFQUFHO0FBRXRELCtFQUErRTtBQUMvRSwwRUFBMEU7QUFDbkUsU0FBU0c7SUFDZCxJQUFJLENBQUNELGtCQUFrQjtRQUNyQixNQUFNLElBQUlFLE1BQU07SUFDbEI7SUFDQSxPQUFPVCxtRUFBWUEsQ0FBQ0MsS0FBTUksWUFBYTtRQUNyQ0ssTUFBTTtZQUFFQyxnQkFBZ0I7WUFBT0Msa0JBQWtCO1FBQU07SUFDekQ7QUFDRjtBQUVBLHNFQUFzRTtBQUMvRCxNQUFNQyxnQkFBZ0JOLG1CQUFtQkMsb0JBQXFCLEtBQWEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zb3VuZG1pbmQvLi9saWIvc3VwYWJhc2VBZG1pbi50cz8wOWQ1Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9zdXBhYmFzZUFkbWluLnRzXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCI7XG5cbmNvbnN0IHVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcbmNvbnN0IHNlcnZpY2VLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZO1xuXG4vLyBFeHBvc2Ugd2hldGhlciB0aGUgc2VydmljZSByb2xlIGtleSBpcyBjb25maWd1cmVkIHNvIEFQSSByb3V0ZXMgY2FuIGJhaWwgZWFybHlcbmV4cG9ydCBjb25zdCB1c2luZ1NlcnZpY2VSb2xlID0gISEodXJsICYmIHNlcnZpY2VLZXkpO1xuXG4vLyBMYXppbHkgY3JlYXRlIGEgU3VwYWJhc2UgY2xpZW50IHRoYXQgdXNlcyB0aGUgc2VydmljZSByb2xlIGtleS4gIFRoaXMgc2hvdWxkXG4vLyBvbmx5IGJlIHVzZWQgaW4gc2VydmVyLXNpZGUgY29kZSBhcyBpdCBoYXMgZnVsbCBhY2Nlc3MgdG8gdGhlIGRhdGFiYXNlLlxuZXhwb3J0IGZ1bmN0aW9uIHN1cGFiYXNlU2VydmljZSgpIHtcbiAgaWYgKCF1c2luZ1NlcnZpY2VSb2xlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSBpcyBub3Qgc2V0XCIpO1xuICB9XG4gIHJldHVybiBjcmVhdGVDbGllbnQodXJsISwgc2VydmljZUtleSEsIHtcbiAgICBhdXRoOiB7IHBlcnNpc3RTZXNzaW9uOiBmYWxzZSwgYXV0b1JlZnJlc2hUb2tlbjogZmFsc2UgfSxcbiAgfSk7XG59XG5cbi8vIENvbnZlbmllbmNlIHNpbmdsZXRvbiBmb3IgY2FsbGVycyB0aGF0IGp1c3QgbmVlZCBhIGNsaWVudCBpbnN0YW5jZS5cbmV4cG9ydCBjb25zdCBzdXBhYmFzZUFkbWluID0gdXNpbmdTZXJ2aWNlUm9sZSA/IHN1cGFiYXNlU2VydmljZSgpIDogKG51bGwgYXMgYW55KTtcbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic2VydmljZUtleSIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJ1c2luZ1NlcnZpY2VSb2xlIiwic3VwYWJhc2VTZXJ2aWNlIiwiRXJyb3IiLCJhdXRoIiwicGVyc2lzdFNlc3Npb24iLCJhdXRvUmVmcmVzaFRva2VuIiwic3VwYWJhc2VBZG1pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabaseAdmin.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Finsights%2Fsummary%2Froute&page=%2Fapi%2Finsights%2Fsummary%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Finsights%2Fsummary%2Froute.ts&appDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();