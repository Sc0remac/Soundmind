"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/spotify/my/attach/route";
exports.ids = ["app/api/spotify/my/attach/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute&page=%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute.ts&appDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute&page=%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute.ts&appDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_cormackerr_Desktop_soundmind_app_api_spotify_my_attach_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/spotify/my/attach/route.ts */ \"(rsc)/./app/api/spotify/my/attach/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/spotify/my/attach/route\",\n        pathname: \"/api/spotify/my/attach\",\n        filename: \"route\",\n        bundlePath: \"app/api/spotify/my/attach/route\"\n    },\n    resolvedPagePath: \"/Users/cormackerr/Desktop/soundmind/app/api/spotify/my/attach/route.ts\",\n    nextConfigOutput,\n    userland: _Users_cormackerr_Desktop_soundmind_app_api_spotify_my_attach_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/spotify/my/attach/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzcG90aWZ5JTJGbXklMkZhdHRhY2glMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnNwb3RpZnklMkZteSUyRmF0dGFjaCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnNwb3RpZnklMkZteSUyRmF0dGFjaCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmNvcm1hY2tlcnIlMkZEZXNrdG9wJTJGc291bmRtaW5kJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmNvcm1hY2tlcnIlMkZEZXNrdG9wJTJGc291bmRtaW5kJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNzQjtBQUNuRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NvdW5kbWluZC8/MzdlNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvY29ybWFja2Vyci9EZXNrdG9wL3NvdW5kbWluZC9hcHAvYXBpL3Nwb3RpZnkvbXkvYXR0YWNoL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9zcG90aWZ5L215L2F0dGFjaC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3Nwb3RpZnkvbXkvYXR0YWNoXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9zcG90aWZ5L215L2F0dGFjaC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9jb3JtYWNrZXJyL0Rlc2t0b3Avc291bmRtaW5kL2FwcC9hcGkvc3BvdGlmeS9teS9hdHRhY2gvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3Nwb3RpZnkvbXkvYXR0YWNoL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute&page=%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute.ts&appDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/spotify/my/attach/route.ts":
/*!********************************************!*\
  !*** ./app/api/spotify/my/attach/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n/* harmony import */ var _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/supabaseServer */ \"(rsc)/./lib/supabaseServer.ts\");\n\n\n\n\nfunction parseScopes(scope) {\n    if (!scope) return [];\n    return scope.split(/[,\\s]+/).map((s)=>s.trim()).filter(Boolean);\n}\nasync function POST(req) {\n    const auth = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.requireUserFromRequest)(req);\n    if (!auth.ok) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        error: auth.error\n    }, {\n        status: auth.status\n    });\n    const user = auth.user;\n    const c = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n    const access = c.get(\"sp_raw_access\")?.value || \"\";\n    const refresh = c.get(\"sp_raw_refresh\")?.value || \"\";\n    const scopeRaw = c.get(\"sp_scope_tmp\")?.value || \"\";\n    const expiresIn = Number(c.get(\"sp_expires_in_tmp\")?.value || \"3600\");\n    const spotifyUserId = c.get(\"sp_user_tmp\")?.value || null;\n    // If no cookies but account exists, accept (idempotent attach)\n    const existing = await _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_3__.supabaseServer.from(\"spotify_accounts\").select(\"user_id\").eq(\"user_id\", user.id).maybeSingle();\n    if (!access) {\n        if (existing.data) {\n            await _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_3__.supabaseServer.from(\"profiles\").update({\n                spotify_connected: true\n            }).eq(\"id\", user.id);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                ok: true,\n                note: \"Already attached\"\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Missing OAuth tokens\"\n        }, {\n            status: 400\n        });\n    }\n    const expires_at = Math.floor(Date.now() / 1000) + (Number.isFinite(expiresIn) ? expiresIn : 3600);\n    // Upsert token bundle (scope stored as text)\n    const up1 = await _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_3__.supabaseServer.from(\"spotify_accounts\").upsert({\n        user_id: user.id,\n        spotify_user_id: spotifyUserId,\n        access_token: access,\n        refresh_token: refresh,\n        scope: scopeRaw,\n        expires_at,\n        connected_at: new Date().toISOString()\n    });\n    if (up1.error) {\n        const msg = up1.error.message || \"attach failed\";\n        // Retry without connected_at if schema cache/type glitch\n        if (/connected_at|schema cache|date\\/time field value/i.test(msg)) {\n            const up2 = await _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_3__.supabaseServer.from(\"spotify_accounts\").upsert({\n                user_id: user.id,\n                spotify_user_id: spotifyUserId,\n                access_token: access,\n                refresh_token: refresh,\n                scope: scopeRaw,\n                expires_at\n            });\n            if (up2.error) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: up2.error.message || \"attach failed (retry)\"\n                }, {\n                    status: 400\n                });\n            }\n        } else {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: msg\n            }, {\n                status: 400\n            });\n        }\n    }\n    // Update profile flags (TRY array first, then FALLBACK to text only; never fail the whole attach)\n    const scopesArr = parseScopes(scopeRaw);\n    const p1 = await _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_3__.supabaseServer.from(\"profiles\").update({\n        spotify_connected: true,\n        spotify_user_id: spotifyUserId,\n        spotify_scopes: scopesArr,\n        spotify_scope_str: scopeRaw || null,\n        spotify_last_sync_at: new Date().toISOString()\n    }).eq(\"id\", user.id);\n    if (p1.error) {\n        const msg = p1.error.message || \"\";\n        // If array write fails for any reason, fall back to text-only write\n        const p2 = await _lib_supabaseServer__WEBPACK_IMPORTED_MODULE_3__.supabaseServer.from(\"profiles\").update({\n            spotify_connected: true,\n            spotify_user_id: spotifyUserId,\n            spotify_scope_str: scopeRaw || null,\n            spotify_last_sync_at: new Date().toISOString()\n        }).eq(\"id\", user.id);\n        if (p2.error) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: p2.error.message || `profile update failed: ${msg}`\n            }, {\n                status: 400\n            });\n        }\n    }\n    // Clear raw cookies after persisting\n    c.delete(\"sp_raw_access\");\n    c.delete(\"sp_raw_refresh\");\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        ok: true\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3Nwb3RpZnkvbXkvYXR0YWNoL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTJDO0FBQ0o7QUFDYTtBQUNFO0FBRXRELFNBQVNJLFlBQVlDLEtBQW9CO0lBQ3ZDLElBQUksQ0FBQ0EsT0FBTyxPQUFPLEVBQUU7SUFDckIsT0FBT0EsTUFBTUMsS0FBSyxDQUFDLFVBQVVDLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsSUFBSSxJQUFJQyxNQUFNLENBQUNDO0FBQ3pEO0FBRU8sZUFBZUMsS0FBS0MsR0FBWTtJQUNyQyxNQUFNQyxPQUFPLE1BQU1aLGlFQUFzQkEsQ0FBQ1c7SUFDMUMsSUFBSSxDQUFDQyxLQUFLQyxFQUFFLEVBQUUsT0FBT2YscURBQVlBLENBQUNnQixJQUFJLENBQUM7UUFBRUMsT0FBT0gsS0FBS0csS0FBSztJQUFDLEdBQUc7UUFBRUMsUUFBUUosS0FBS0ksTUFBTTtJQUFDO0lBQ3BGLE1BQU1DLE9BQU9MLEtBQUtLLElBQUk7SUFFdEIsTUFBTUMsSUFBSW5CLHFEQUFPQTtJQUNqQixNQUFNb0IsU0FBU0QsRUFBRUUsR0FBRyxDQUFDLGtCQUFrQkMsU0FBUztJQUNoRCxNQUFNQyxVQUFVSixFQUFFRSxHQUFHLENBQUMsbUJBQW1CQyxTQUFTO0lBQ2xELE1BQU1FLFdBQVdMLEVBQUVFLEdBQUcsQ0FBQyxpQkFBaUJDLFNBQVM7SUFDakQsTUFBTUcsWUFBWUMsT0FBT1AsRUFBRUUsR0FBRyxDQUFDLHNCQUFzQkMsU0FBUztJQUM5RCxNQUFNSyxnQkFBZ0JSLEVBQUVFLEdBQUcsQ0FBQyxnQkFBZ0JDLFNBQVM7SUFFckQsK0RBQStEO0lBQy9ELE1BQU1NLFdBQVcsTUFBTTFCLCtEQUFjQSxDQUNsQzJCLElBQUksQ0FBQyxvQkFDTEMsTUFBTSxDQUFDLFdBQ1BDLEVBQUUsQ0FBQyxXQUFXYixLQUFLYyxFQUFFLEVBQ3JCQyxXQUFXO0lBRWQsSUFBSSxDQUFDYixRQUFRO1FBQ1gsSUFBSVEsU0FBU00sSUFB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SUFDRjtJQUVBLHFDQUFxQztJQUNyQ0UsRUFBRTJDLE1BQU0sQ0FBQztJQUNUM0MsRUFBRTJDLE1BQU0sQ0FBQztJQUVULE9BQU8vRCxxREFBWUEsQ0FBQ2dCLElBQUksQ0FBQztRQUFFRCxJQUFJO0lBQUs7QUFDdEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zb3VuZG1pbmQvLi9hcHAvYXBpL3Nwb3RpZnkvbXkvYXR0YWNoL3JvdXRlLnRzP2RiOWMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiO1xuaW1wb3J0IHsgcmVxdWlyZVVzZXJGcm9tUmVxdWVzdCB9IGZyb20gXCJAL2xpYi9hdXRoXCI7XG5pbXBvcnQgeyBzdXBhYmFzZVNlcnZlciB9IGZyb20gXCJAL2xpYi9zdXBhYmFzZVNlcnZlclwiO1xuXG5mdW5jdGlvbiBwYXJzZVNjb3BlcyhzY29wZTogc3RyaW5nIHwgbnVsbCk6IHN0cmluZ1tdIHtcbiAgaWYgKCFzY29wZSkgcmV0dXJuIFtdO1xuICByZXR1cm4gc2NvcGUuc3BsaXQoL1ssXFxzXSsvKS5tYXAocyA9PiBzLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXE6IFJlcXVlc3QpIHtcbiAgY29uc3QgYXV0aCA9IGF3YWl0IHJlcXVpcmVVc2VyRnJvbVJlcXVlc3QocmVxKTtcbiAgaWYgKCFhdXRoLm9rKSByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogYXV0aC5lcnJvciB9LCB7IHN0YXR1czogYXV0aC5zdGF0dXMgfSk7XG4gIGNvbnN0IHVzZXIgPSBhdXRoLnVzZXI7XG5cbiAgY29uc3QgYyA9IGNvb2tpZXMoKTtcbiAgY29uc3QgYWNjZXNzID0gYy5nZXQoXCJzcF9yYXdfYWNjZXNzXCIpPy52YWx1ZSB8fCBcIlwiO1xuICBjb25zdCByZWZyZXNoID0gYy5nZXQoXCJzcF9yYXdfcmVmcmVzaFwiKT8udmFsdWUgfHwgXCJcIjtcbiAgY29uc3Qgc2NvcGVSYXcgPSBjLmdldChcInNwX3Njb3BlX3RtcFwiKT8udmFsdWUgfHwgXCJcIjtcbiAgY29uc3QgZXhwaXJlc0luID0gTnVtYmVyKGMuZ2V0KFwic3BfZXhwaXJlc19pbl90bXBcIik/LnZhbHVlIHx8IFwiMzYwMFwiKTtcbiAgY29uc3Qgc3BvdGlmeVVzZXJJZCA9IGMuZ2V0KFwic3BfdXNlcl90bXBcIik/LnZhbHVlIHx8IG51bGw7XG5cbiAgLy8gSWYgbm8gY29va2llcyBidXQgYWNjb3VudCBleGlzdHMsIGFjY2VwdCAoaWRlbXBvdGVudCBhdHRhY2gpXG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgc3VwYWJhc2VTZXJ2ZXJcbiAgICAuZnJvbShcInNwb3RpZnlfYWNjb3VudHNcIilcbiAgICAuc2VsZWN0KFwidXNlcl9pZFwiKVxuICAgIC5lcShcInVzZXJfaWRcIiwgdXNlci5pZClcbiAgICAubWF5YmVTaW5nbGUoKTtcblxuICBpZiAoIWFjY2Vzcykge1xuICAgIGlmIChleGlzdGluZy5kYXRhKSB7XG4gICAgICBhd2FpdCBzdXBhYmFzZVNlcnZlci5mcm9tKFwicHJvZmlsZXNcIikudXBkYXRlKHsgc3BvdGlmeV9jb25uZWN0ZWQ6IHRydWUgfSkuZXEoXCJpZFwiLCB1c2VyLmlkKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9rOiB0cnVlLCBub3RlOiBcIkFscmVhZHkgYXR0YWNoZWRcIiB9KTtcbiAgICB9XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTWlzc2luZyBPQXV0aCB0b2tlbnNcIiB9LCB7IHN0YXR1czogNDAwIH0pO1xuICB9XG5cbiAgY29uc3QgZXhwaXJlc19hdCA9IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApICsgKE51bWJlci5pc0Zpbml0ZShleHBpcmVzSW4pID8gZXhwaXJlc0luIDogMzYwMCk7XG5cbiAgLy8gVXBzZXJ0IHRva2VuIGJ1bmRsZSAoc2NvcGUgc3RvcmVkIGFzIHRleHQpXG4gIGNvbnN0IHVwMSA9IGF3YWl0IHN1cGFiYXNlU2VydmVyLmZyb20oXCJzcG90aWZ5X2FjY291bnRzXCIpLnVwc2VydCh7XG4gICAgdXNlcl9pZDogdXNlci5pZCxcbiAgICBzcG90aWZ5X3VzZXJfaWQ6IHNwb3RpZnlVc2VySWQsXG4gICAgYWNjZXNzX3Rva2VuOiBhY2Nlc3MsXG4gICAgcmVmcmVzaF90b2tlbjogcmVmcmVzaCxcbiAgICBzY29wZTogc2NvcGVSYXcsXG4gICAgZXhwaXJlc19hdCxcbiAgICBjb25uZWN0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICB9KTtcbiAgaWYgKHVwMS5lcnJvcikge1xuICAgIGNvbnN0IG1zZyA9IHVwMS5lcnJvci5tZXNzYWdlIHx8IFwiYXR0YWNoIGZhaWxlZFwiO1xuICAgIC8vIFJldHJ5IHdpdGhvdXQgY29ubmVjdGVkX2F0IGlmIHNjaGVtYSBjYWNoZS90eXBlIGdsaXRjaFxuICAgIGlmICgvY29ubmVjdGVkX2F0fHNjaGVtYSBjYWNoZXxkYXRlXFwvdGltZSBmaWVsZCB2YWx1ZS9pLnRlc3QobXNnKSkge1xuICAgICAgY29uc3QgdXAyID0gYXdhaXQgc3VwYWJhc2VTZXJ2ZXIuZnJvbShcInNwb3RpZnlfYWNjb3VudHNcIikudXBzZXJ0KHtcbiAgICAgICAgdXNlcl9pZDogdXNlci5pZCxcbiAgICAgICAgc3BvdGlmeV91c2VyX2lkOiBzcG90aWZ5VXNlcklkLFxuICAgICAgICBhY2Nlc3NfdG9rZW46IGFjY2VzcyxcbiAgICAgICAgcmVmcmVzaF90b2tlbjogcmVmcmVzaCxcbiAgICAgICAgc2NvcGU6IHNjb3BlUmF3LFxuICAgICAgICBleHBpcmVzX2F0XG4gICAgICB9KTtcbiAgICAgIGlmICh1cDIuZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IHVwMi5lcnJvci5tZXNzYWdlIHx8IFwiYXR0YWNoIGZhaWxlZCAocmV0cnkpXCIgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IG1zZyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIFVwZGF0ZSBwcm9maWxlIGZsYWdzIChUUlkgYXJyYXkgZmlyc3QsIHRoZW4gRkFMTEJBQ0sgdG8gdGV4dCBvbmx5OyBuZXZlciBmYWlsIHRoZSB3aG9sZSBhdHRhY2gpXG4gIGNvbnN0IHNjb3Blc0FyciA9IHBhcnNlU2NvcGVzKHNjb3BlUmF3KTtcblxuICBjb25zdCBwMSA9IGF3YWl0IHN1cGFiYXNlU2VydmVyLmZyb20oXCJwcm9maWxlc1wiKVxuICAgIC51cGRhdGUoe1xuICAgICAgc3BvdGlmeV9jb25uZWN0ZWQ6IHRydWUsXG4gICAgICBzcG90aWZ5X3VzZXJfaWQ6IHNwb3RpZnlVc2VySWQsXG4gICAgICBzcG90aWZ5X3Njb3Blczogc2NvcGVzQXJyLCAgICAgICAgICAvLyB0ZXh0W11cbiAgICAgIHNwb3RpZnlfc2NvcGVfc3RyOiBzY29wZVJhdyB8fCBudWxsLFxuICAgICAgc3BvdGlmeV9sYXN0X3N5bmNfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH0pXG4gICAgLmVxKFwiaWRcIiwgdXNlci5pZCk7XG5cbiAgaWYgKHAxLmVycm9yKSB7XG4gICAgY29uc3QgbXNnID0gcDEuZXJyb3IubWVzc2FnZSB8fCBcIlwiO1xuICAgIC8vIElmIGFycmF5IHdyaXRlIGZhaWxzIGZvciBhbnkgcmVhc29uLCBmYWxsIGJhY2sgdG8gdGV4dC1vbmx5IHdyaXRlXG4gICAgY29uc3QgcDIgPSBhd2FpdCBzdXBhYmFzZVNlcnZlci5mcm9tKFwicHJvZmlsZXNcIilcbiAgICAgIC51cGRhdGUoe1xuICAgICAgICBzcG90aWZ5X2Nvbm5lY3RlZDogdHJ1ZSxcbiAgICAgICAgc3BvdGlmeV91c2VyX2lkOiBzcG90aWZ5VXNlcklkLFxuICAgICAgICBzcG90aWZ5X3Njb3BlX3N0cjogc2NvcGVSYXcgfHwgbnVsbCxcbiAgICAgICAgc3BvdGlmeV9sYXN0X3N5bmNfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfSlcbiAgICAgIC5lcShcImlkXCIsIHVzZXIuaWQpO1xuXG4gICAgaWYgKHAyLmVycm9yKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogcDIuZXJyb3IubWVzc2FnZSB8fCBgcHJvZmlsZSB1cGRhdGUgZmFpbGVkOiAke21zZ31gIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gQ2xlYXIgcmF3IGNvb2tpZXMgYWZ0ZXIgcGVyc2lzdGluZ1xuICBjLmRlbGV0ZShcInNwX3Jhd19hY2Nlc3NcIik7XG4gIGMuZGVsZXRlKFwic3BfcmF3X3JlZnJlc2hcIik7XG5cbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6IHRydWUgfSk7XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY29va2llcyIsInJlcXVpcmVVc2VyRnJvbVJlcXVlc3QiLCJzdXBhYmFzZVNlcnZlciIsInBhcnNlU2NvcGVzIiwic2NvcGUiLCJzcGxpdCIsIm1hcCIsInMiLCJ0cmltIiwiZmlsdGVyIiwiQm9vbGVhbiIsIlBPU1QiLCJyZXEiLCJhdXRoIiwib2siLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJ1c2VyIiwiYyIsImFjY2VzcyIsImdldCIsInZhbHVlIiwicmVmcmVzaCIsInNjb3BlUmF3IiwiZXhwaXJlc0luIiwiTnVtYmVyIiwic3BvdGlmeVVzZXJJZCIsImV4aXN0aW5nIiwiZnJvbSIsInNlbGVjdCIsImVxIiwiaWQiLCJtYXliZVNpbmdsZSIsImRhdGEiLCJ1cGRhdGUiLCJzcG90aWZ5X2Nvbm5lY3RlZCIsIm5vdGUiLCJleHBpcmVzX2F0IiwiTWF0aCIsImZsb29yIiwiRGF0ZSIsIm5vdyIsImlzRmluaXRlIiwidXAxIiwidXBzZXJ0IiwidXNlcl9pZCIsInNwb3RpZnlfdXNlcl9pZCIsImFjY2Vzc190b2tlbiIsInJlZnJlc2hfdG9rZW4iLCJjb25uZWN0ZWRfYXQiLCJ0b0lTT1N0cmluZyIsIm1zZyIsIm1lc3NhZ2UiLCJ0ZXN0IiwidXAyIiwic2NvcGVzQXJyIiwicDEiLCJzcG90aWZ5X3Njb3BlcyIsInNwb3RpZnlfc2NvcGVfc3RyIiwic3BvdGlmeV9sYXN0X3N5bmNfYXQiLCJwMiIsImRlbGV0ZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/spotify/my/attach/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   requireUserFromRequest: () => (/* binding */ requireUserFromRequest)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var _env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./env */ \"(rsc)/./lib/env.ts\");\n\n\nconst admin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(_env__WEBPACK_IMPORTED_MODULE_0__.ENV.SUPABASE_URL, _env__WEBPACK_IMPORTED_MODULE_0__.ENV.SUPABASE_SERVICE_ROLE_KEY, {\n    auth: {\n        persistSession: false\n    }\n});\nasync function requireUserFromRequest(req) {\n    const auth = req.headers.get(\"authorization\") || \"\";\n    const m = auth.match(/^Bearer\\s+(.+)$/i);\n    if (!m) {\n        return {\n            ok: false,\n            status: 401,\n            error: \"Missing bearer token\"\n        };\n    }\n    const token = m[1];\n    const { data, error } = await admin.auth.getUser(token);\n    if (error || !data.user) {\n        return {\n            ok: false,\n            status: 401,\n            error: \"Invalid token\"\n        };\n    }\n    return {\n        ok: true,\n        user: data.user\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBcUQ7QUFDekI7QUFFNUIsTUFBTUUsUUFBUUYsbUVBQVlBLENBQUNDLHFDQUFHQSxDQUFDRSxZQUFZLEVBQUVGLHFDQUFHQSxDQUFDRyx5QkFBeUIsRUFBRTtJQUMxRUMsTUFBTTtRQUFFQyxnQkFBZ0I7SUFBTTtBQUNoQztBQUVPLGVBQWVDLHVCQUF1QkMsR0FBWTtJQUN2RCxNQUFNSCxPQUFPRyxJQUFJQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxvQkFBb0I7SUFDakQsTUFBTUMsSUFBSU4sS0FBS08sS0FBSyxDQUFDO0lBQ3JCLElBQUksQ0FBQ0QsR0FBRztRQUNOLE9BQU87WUFBRUUsSUFBSTtZQUFnQkMsUUFBUTtZQUFLQyxPQUFPO1FBQXVCO0lBQzFFO0lBQ0EsTUFBTUMsUUFBUUwsQ0FBQyxDQUFDLEVBQUU7SUFDbEIsTUFBTSxFQUFFTSxJQUFJLEVBQUVGLEtBQUssRUFBRSxHQUFHLE1BQU1iLE1BQU1HLElBQUksQ0FBQ2EsT0FBTyxDQUFDRjtJQUNqRCxJQUFJRCxTQUFTLENBQUNFLEtBQUtFLElBQUksRUFBRTtRQUN2QixPQUFPO1lBQUVOLElBQUk7WUFBZ0JDLFFBQVE7WUFBS0MsT0FBTztRQUFnQjtJQUNuRTtJQUNBLE9BQU87UUFBRUYsSUFBSTtRQUFlTSxNQUFNRixLQUFLRSxJQUFJO0lBQUM7QUFDOUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zb3VuZG1pbmQvLi9saWIvYXV0aC50cz9iZjdlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gXCJAc3VwYWJhc2Uvc3VwYWJhc2UtanNcIjtcbmltcG9ydCB7IEVOViB9IGZyb20gXCIuL2VudlwiO1xuXG5jb25zdCBhZG1pbiA9IGNyZWF0ZUNsaWVudChFTlYuU1VQQUJBU0VfVVJMLCBFTlYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSwge1xuICBhdXRoOiB7IHBlcnNpc3RTZXNzaW9uOiBmYWxzZSB9LFxufSk7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlVXNlckZyb21SZXF1ZXN0KHJlcTogUmVxdWVzdCkge1xuICBjb25zdCBhdXRoID0gcmVxLmhlYWRlcnMuZ2V0KFwiYXV0aG9yaXphdGlvblwiKSB8fCBcIlwiO1xuICBjb25zdCBtID0gYXV0aC5tYXRjaCgvXkJlYXJlclxccysoLispJC9pKTtcbiAgaWYgKCFtKSB7XG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlIGFzIGNvbnN0LCBzdGF0dXM6IDQwMSwgZXJyb3I6IFwiTWlzc2luZyBiZWFyZXIgdG9rZW5cIiB9O1xuICB9XG4gIGNvbnN0IHRva2VuID0gbVsxXTtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYWRtaW4uYXV0aC5nZXRVc2VyKHRva2VuKTtcbiAgaWYgKGVycm9yIHx8ICFkYXRhLnVzZXIpIHtcbiAgICByZXR1cm4geyBvazogZmFsc2UgYXMgY29uc3QsIHN0YXR1czogNDAxLCBlcnJvcjogXCJJbnZhbGlkIHRva2VuXCIgfTtcbiAgfVxuICByZXR1cm4geyBvazogdHJ1ZSBhcyBjb25zdCwgdXNlcjogZGF0YS51c2VyIH07XG59XG4iXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50IiwiRU5WIiwiYWRtaW4iLCJTVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiYXV0aCIsInBlcnNpc3RTZXNzaW9uIiwicmVxdWlyZVVzZXJGcm9tUmVxdWVzdCIsInJlcSIsImhlYWRlcnMiLCJnZXQiLCJtIiwibWF0Y2giLCJvayIsInN0YXR1cyIsImVycm9yIiwidG9rZW4iLCJkYXRhIiwiZ2V0VXNlciIsInVzZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/env.ts":
/*!********************!*\
  !*** ./lib/env.ts ***!
  \********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ENV: () => (/* binding */ ENV)\n/* harmony export */ });\nconst ENV = {\n    APP_BASE_URL: process.env.APP_BASE_URL,\n    SPOTIFY_REDIRECT_URI: process.env.SPOTIFY_REDIRECT_URI,\n    SPOTIFY_CLIENT_ID: process.env.SPOTIFY_CLIENT_ID,\n    SPOTIFY_CLIENT_SECRET: process.env.SPOTIFY_CLIENT_SECRET,\n    SUPABASE_URL: \"https://awxeorfppxdsygnhxlth.supabase.co\",\n    SUPABASE_ANON_KEY: \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF3eGVvcmZwcHhkc3lnbmh4bHRoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2MTExOTUsImV4cCI6MjA3MDE4NzE5NX0.62qbnPYJc-UKAYiedhe9EhMcTTgO5iX6RniGKGr6rtk\",\n    SUPABASE_SERVICE_ROLE_KEY: process.env.SUPABASE_SERVICE_ROLE_KEY\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZW52LnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTyxNQUFNQSxNQUFNO0lBQ2pCQyxjQUFjQyxRQUFRQyxHQUFHLENBQUNGLFlBQVk7SUFDdENHLHNCQUFzQkYsUUFBUUMsR0FBRyxDQUFDQyxvQkFBb0I7SUFDdERDLG1CQUFtQkgsUUFBUUMsR0FBRyxDQUFDRSxpQkFBaUI7SUFDaERDLHVCQUF1QkosUUFBUUMsR0FBRyxDQUFDRyxxQkFBcUI7SUFDeERDLGNBQWNMLDBDQUFvQztJQUNsRE8sbUJBQW1CUCxrTkFBeUM7SUFDNURTLDJCQUEyQlQsUUFBUUMsR0FBRyxDQUFDUSx5QkFBeUI7QUFDbEUsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NvdW5kbWluZC8uL2xpYi9lbnYudHM/OTNmMiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgRU5WID0ge1xuICBBUFBfQkFTRV9VUkw6IHByb2Nlc3MuZW52LkFQUF9CQVNFX1VSTCEsXG4gIFNQT1RJRllfUkVESVJFQ1RfVVJJOiBwcm9jZXNzLmVudi5TUE9USUZZX1JFRElSRUNUX1VSSSEsXG4gIFNQT1RJRllfQ0xJRU5UX0lEOiBwcm9jZXNzLmVudi5TUE9USUZZX0NMSUVOVF9JRCEsXG4gIFNQT1RJRllfQ0xJRU5UX1NFQ1JFVDogcHJvY2Vzcy5lbnYuU1BPVElGWV9DTElFTlRfU0VDUkVUISxcbiAgU1VQQUJBU0VfVVJMOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxuICBTVVBBQkFTRV9BTk9OX0tFWTogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxuICBTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZOiBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZISxcbn07XG4iXSwibmFtZXMiOlsiRU5WIiwiQVBQX0JBU0VfVVJMIiwicHJvY2VzcyIsImVudiIsIlNQT1RJRllfUkVESVJFQ1RfVVJJIiwiU1BPVElGWV9DTElFTlRfSUQiLCJTUE9USUZZX0NMSUVOVF9TRUNSRVQiLCJTVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9BTk9OX0tFWSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/env.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabaseServer.ts":
/*!*******************************!*\
  !*** ./lib/supabaseServer.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabaseServer: () => (/* binding */ supabaseServer)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var _env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./env */ \"(rsc)/./lib/env.ts\");\n\n\nconst supabaseServer = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(_env__WEBPACK_IMPORTED_MODULE_0__.ENV.SUPABASE_URL, _env__WEBPACK_IMPORTED_MODULE_0__.ENV.SUPABASE_ANON_KEY, {\n    auth: {\n        persistSession: false\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2VTZXJ2ZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXFEO0FBQ3pCO0FBRXJCLE1BQU1FLGlCQUFpQkYsbUVBQVlBLENBQ3hDQyxxQ0FBR0EsQ0FBQ0UsWUFBWSxFQUNoQkYscUNBQUdBLENBQUNHLGlCQUFpQixFQUNyQjtJQUFFQyxNQUFNO1FBQUVDLGdCQUFnQjtJQUFNO0FBQUUsR0FDbEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zb3VuZG1pbmQvLi9saWIvc3VwYWJhc2VTZXJ2ZXIudHM/Yzc4YyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCI7XG5pbXBvcnQgeyBFTlYgfSBmcm9tIFwiLi9lbnZcIjtcblxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlU2VydmVyID0gY3JlYXRlQ2xpZW50KFxuICBFTlYuU1VQQUJBU0VfVVJMLFxuICBFTlYuU1VQQUJBU0VfQU5PTl9LRVksXG4gIHsgYXV0aDogeyBwZXJzaXN0U2Vzc2lvbjogZmFsc2UgfSB9XG4pO1xuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsIkVOViIsInN1cGFiYXNlU2VydmVyIiwiU1VQQUJBU0VfVVJMIiwiU1VQQUJBU0VfQU5PTl9LRVkiLCJhdXRoIiwicGVyc2lzdFNlc3Npb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabaseServer.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute&page=%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fspotify%2Fmy%2Fattach%2Froute.ts&appDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcormackerr%2FDesktop%2Fsoundmind&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();